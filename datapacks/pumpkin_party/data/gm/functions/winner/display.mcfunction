# check for "next highest"
scoreboard players set #max tmp -10000
scoreboard players operation #max tmp > @a[tag=gm_high] gm_points
execute as @a[tag=gm_high] if score @s gm_points = #max tmp run tag @s add gm_lead

scoreboard players operation #seconds tmp = @a[tag=gm_lead] tmp
scoreboard players operation #seconds tmp /= 20 const
scoreboard players operation #minutes tmp = #seconds tmp
scoreboard players operation #seconds tmp %= 60 const
scoreboard players operation #minutes tmp /= 60 const

execute if score #rank tmp matches 1 if score #seconds tmp matches 10.. as @a[tag=gm_lead,gamemode=adventure] run tellraw @a [{"color":"#ffd700","text":""},{"score": {"name": "#rank","objective": "tmp"}},". ",{"selector": "@s"}, " survived for ", {"score": {"name": "#minutes","objective": "tmp"}},":",{"score": {"name": "#seconds","objective": "tmp"}},{"text":" (+","color":"gray"},{"score": {"name": "@s","objective": "gm_points"},"color":"gray"},{"text":" candies)","color":"gray"}]
execute if score #rank tmp matches 1 if score #seconds tmp matches ..9 as @a[tag=gm_lead,gamemode=adventure] run tellraw @a [{"color":"#ffd700","text":""},{"score": {"name": "#rank","objective": "tmp"}},". ",{"selector": "@s"}, " survived for ", {"score": {"name": "#minutes","objective": "tmp"}},":0",{"score": {"name": "#seconds","objective": "tmp"}},{"text":" (+","color":"gray"},{"score": {"name": "@s","objective": "gm_points"},"color":"gray"},{"text":" candies)","color":"gray"}]
execute if score #rank tmp matches 1 if score #seconds tmp matches 10.. as @a[tag=gm_lead,gamemode=spectator] run tellraw @a [{"color":"#ffd700","text":""},{"score": {"name": "#rank","objective": "tmp"}},". ",{"selector": "@s"}, " got eaten after ", {"score": {"name": "#minutes","objective": "tmp"}},":",{"score": {"name": "#seconds","objective": "tmp"}},{"text":" (+","color":"gray"},{"score": {"name": "@s","objective": "gm_points"},"color":"gray"},{"text":" candies)","color":"gray"}]
execute if score #rank tmp matches 1 if score #seconds tmp matches ..9 as @a[tag=gm_lead,gamemode=spectator] run tellraw @a [{"color":"#ffd700","text":""},{"score": {"name": "#rank","objective": "tmp"}},". ",{"selector": "@s"}, " got eaten after ", {"score": {"name": "#minutes","objective": "tmp"}},":0",{"score": {"name": "#seconds","objective": "tmp"}},{"text":" (+","color":"gray"},{"score": {"name": "@s","objective": "gm_points"},"color":"gray"},{"text":" candies)","color":"gray"}]
execute if score #rank tmp matches 2 if score #seconds tmp matches 10.. as @a[tag=gm_lead,gamemode=adventure] run tellraw @a [{"color":"#c0c0c0","text":""},{"score": {"name": "#rank","objective": "tmp"}},". ",{"selector": "@s"}, " survived for ", {"score": {"name": "#minutes","objective": "tmp"}},":",{"score": {"name": "#seconds","objective": "tmp"}},{"text":" (+","color":"gray"},{"score": {"name": "@s","objective": "gm_points"},"color":"gray"},{"text":" candies)","color":"gray"}]
execute if score #rank tmp matches 2 if score #seconds tmp matches ..9 as @a[tag=gm_lead,gamemode=adventure] run tellraw @a [{"color":"#c0c0c0","text":""},{"score": {"name": "#rank","objective": "tmp"}},". ",{"selector": "@s"}, " survived for ", {"score": {"name": "#minutes","objective": "tmp"}},":0",{"score": {"name": "#seconds","objective": "tmp"}},{"text":" (+","color":"gray"},{"score": {"name": "@s","objective": "gm_points"},"color":"gray"},{"text":" candies)","color":"gray"}]
execute if score #rank tmp matches 2 if score #seconds tmp matches 10.. as @a[tag=gm_lead,gamemode=spectator] run tellraw @a [{"color":"#c0c0c0","text":""},{"score": {"name": "#rank","objective": "tmp"}},". ",{"selector": "@s"}, " got eaten after ", {"score": {"name": "#minutes","objective": "tmp"}},":",{"score": {"name": "#seconds","objective": "tmp"}},{"text":" (+","color":"gray"},{"score": {"name": "@s","objective": "gm_points"},"color":"gray"},{"text":" candies)","color":"gray"}]
execute if score #rank tmp matches 2 if score #seconds tmp matches ..9 as @a[tag=gm_lead,gamemode=spectator] run tellraw @a [{"color":"#c0c0c0","text":""},{"score": {"name": "#rank","objective": "tmp"}},". ",{"selector": "@s"}, " got eaten after ", {"score": {"name": "#minutes","objective": "tmp"}},":0",{"score": {"name": "#seconds","objective": "tmp"}},{"text":" (+","color":"gray"},{"score": {"name": "@s","objective": "gm_points"},"color":"gray"},{"text":" candies)","color":"gray"}]
execute if score #rank tmp matches 3 if score #seconds tmp matches 10.. as @a[tag=gm_lead,gamemode=adventure] run tellraw @a [{"color":"#cd7f32","text":""},{"score": {"name": "#rank","objective": "tmp"}},". ",{"selector": "@s"}, " survived for ", {"score": {"name": "#minutes","objective": "tmp"}},":",{"score": {"name": "#seconds","objective": "tmp"}},{"text":" (+","color":"gray"},{"score": {"name": "@s","objective": "gm_points"},"color":"gray"},{"text":" candies)","color":"gray"}]
execute if score #rank tmp matches 3 if score #seconds tmp matches ..9 as @a[tag=gm_lead,gamemode=adventure] run tellraw @a [{"color":"#cd7f32","text":""},{"score": {"name": "#rank","objective": "tmp"}},". ",{"selector": "@s"}, " survived for ", {"score": {"name": "#minutes","objective": "tmp"}},":0",{"score": {"name": "#seconds","objective": "tmp"}},{"text":" (+","color":"gray"},{"score": {"name": "@s","objective": "gm_points"},"color":"gray"},{"text":" candies)","color":"gray"}]
execute if score #rank tmp matches 3 if score #seconds tmp matches 10.. as @a[tag=gm_lead,gamemode=spectator] run tellraw @a [{"color":"#cd7f32","text":""},{"score": {"name": "#rank","objective": "tmp"}},". ",{"selector": "@s"}, " got eaten after ", {"score": {"name": "#minutes","objective": "tmp"}},":",{"score": {"name": "#seconds","objective": "tmp"}},{"text":" (+","color":"gray"},{"score": {"name": "@s","objective": "gm_points"},"color":"gray"},{"text":" candies)","color":"gray"}]
execute if score #rank tmp matches 3 if score #seconds tmp matches ..9 as @a[tag=gm_lead,gamemode=spectator] run tellraw @a [{"color":"#cd7f32","text":""},{"score": {"name": "#rank","objective": "tmp"}},". ",{"selector": "@s"}, " got eaten after ", {"score": {"name": "#minutes","objective": "tmp"}},":0",{"score": {"name": "#seconds","objective": "tmp"}},{"text":" (+","color":"gray"},{"score": {"name": "@s","objective": "gm_points"},"color":"gray"},{"text":" candies)","color":"gray"}]
execute if score #rank tmp matches 4.. if score #seconds tmp matches 10.. as @a[tag=gm_lead,gamemode=adventure] run tellraw @a [{"color":"white","text":""},{"score": {"name": "#rank","objective": "tmp"}},". ",{"selector": "@s"}, " survived for ", {"score": {"name": "#minutes","objective": "tmp"}},":",{"score": {"name": "#seconds","objective": "tmp"}},{"text":" (+","color":"gray"},{"score": {"name": "@s","objective": "gm_points"},"color":"gray"},{"text":" candies)","color":"gray"}]
execute if score #rank tmp matches 4.. if score #seconds tmp matches ..9 as @a[tag=gm_lead,gamemode=adventure] run tellraw @a [{"color":"white","text":""},{"score": {"name": "#rank","objective": "tmp"}},". ",{"selector": "@s"}, " survived for ", {"score": {"name": "#minutes","objective": "tmp"}},":0",{"score": {"name": "#seconds","objective": "tmp"}},{"text":" (+","color":"gray"},{"score": {"name": "@s","objective": "gm_points"},"color":"gray"},{"text":" candies)","color":"gray"}]
execute if score #rank tmp matches 4.. if score #seconds tmp matches 10.. as @a[tag=gm_lead,gamemode=spectator] run tellraw @a [{"color":"white","text":""},{"score": {"name": "#rank","objective": "tmp"}},". ",{"selector": "@s"}, " got eaten after ", {"score": {"name": "#minutes","objective": "tmp"}},":",{"score": {"name": "#seconds","objective": "tmp"}},{"text":" (+","color":"gray"},{"score": {"name": "@s","objective": "gm_points"},"color":"gray"},{"text":" candies)","color":"gray"}]
execute if score #rank tmp matches 4.. if score #seconds tmp matches ..9 as @a[tag=gm_lead,gamemode=spectator] run tellraw @a [{"color":"white","text":""},{"score": {"name": "#rank","objective": "tmp"}},". ",{"selector": "@s"}, " got eaten after ", {"score": {"name": "#minutes","objective": "tmp"}},":0",{"score": {"name": "#seconds","objective": "tmp"}},{"text":" (+","color":"gray"},{"score": {"name": "@s","objective": "gm_points"},"color":"gray"},{"text":" candies)","color":"gray"}]

tag @a[tag=gm_lead] remove gm_high
tag @a[tag=gm_lead] remove gm_lead
scoreboard players add #rank tmp 1
execute if entity @a[tag=gm_high] run function gm:winner/display